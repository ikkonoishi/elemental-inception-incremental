//Maybe svg?
//histData.machines.machineEarth.icon = new Path2D("m 5.2556677,0 c -0.390329,0.80339601 -0.780658,1.606791 -1.170987,2.410187 -0.374381,-0.288541 -1.16715,-1.110218 -1.276546,-1.062032 0.573844,0.479796 1.489496,1.494472 0.32386,1.875107 -0.53145,0.541002 -1.697548,0.582387 -1.99353,0.133375 0.287657,0.825231 1.038021,0.824633 1.638582,0.329308 0.807902,-0.398228 1.636187,-1.005303 1.839514,-1.935461 0.150744,-0.87455999 1.369856,-1.274329 1.575412,-0.224839 0.339291,0.690281 0.755427,1.680507 1.679025,1.610566 C 9.5355817,2.933547 10.589455,1.496681 11.650626,0.358117 10.670244,1.225296 9.7477167,2.205212 8.5473327,2.772513 8.1648887,1.958977 9.2217567,1.259416 9.7884277,0.84077501 10.127274,0.78873501 10.897603,0.133923 10.080373,0.436639 9.2520327,0.92437501 8.0255387,1.603348 7.2278667,0.72448201 6.9446987,0.415786 7.6660007,-0.110005 7.1338267,0.330231 6.8065817,0.84187701 6.1265967,1.594841 5.7613827,0.64264301 5.5928217,0.428421 5.4242517,0.214207 5.2556727,0 Z m 1.848467,1.156001 c 0.925625,-0.31688699 1.805881,1.167186 0.766645,1.597443 -0.759459,0.356179 -1.591188,-0.916908 -1.086494,-1.510372 0.09389,-0.06546 0.208422,-0.08601 0.319849,-0.087071 z m 6.4089123,1.149284 c 0.284528,0.968397 -0.586308,1.687421 -1.178215,2.297248 -0.0825,0.648891 0.458205,1.266683 0.778381,1.825949 0.594388,0.785998 1.514445,1.434675 2.530622,1.427643 0.184899,-0.301626 -0.982228,-0.365425 -1.290604,-0.627613 -1.0893,-0.30018 -0.06387,-1.728691 0.661907,-1.041789 0.344587,0.242992 0.865094,0.880762 1.044415,0.949415 C 14.672625,5.854697 14.23707,3.971583 13.513047,2.305285 Z m 0.256831,1.223698 c 0.798263,0.627376 -1.380096,1.340448 -0.525246,0.397133 0.14618,-0.163689 0.307746,-0.332775 0.525246,-0.397133 z m -5.7986143,0.58756 c -2.34565,-0.08512 -4.39039,2.291314 -3.965532,4.599892 0.297079,2.206223 2.676965,3.875964 4.852305,3.313107 C 10.917335,11.57994 12.407963,9.328698 11.88772,7.258515 11.504346,5.487141 9.8016507,4.06617 7.9712637,4.116543 Z m -0.04599,0.226343 C 10.153984,4.233555 12.118738,6.487721 11.712914,8.682527 11.432363,10.767024 9.1815207,12.342258 7.1273807,11.806729 5.1321467,11.369277 3.7181537,9.134104 4.3148757,7.149651 4.7363527,5.568355 6.2700367,4.318519 7.9252737,4.342886 Z M 13.753341,4.593 C 14.840026,4.766162 14.238868,6.298266 13.474817,6.51483 13.098004,6.16262 12.549133,5.329387 12.788687,4.819204 13.074175,4.63644 13.431072,4.651719 13.753341,4.593 Z M 0.08130673,5.563999 C 0.40189673,6.090297 2.0377577,6.48786 0.8928467,7.149256 0.5703217,7.26859 -0.39955227,7.895622 0.51654973,7.700413 1.1267147,7.537834 1.4965327,8.360177 0.6569767,8.270825 0.34001073,8.293955 -0.45310227,8.791552 0.34549673,8.605284 1.0560617,8.422337 2.0125317,8.469746 2.4154957,7.742708 2.5116157,6.642971 1.1749587,6.075922 0.34831273,5.647739 c -0.07939,-0.06116 -0.175106,-0.06585 -0.267006,-0.08374 z M 1.8088507,6.934977 c 1.08233,0.263347 -0.254427,1.639681 -0.699339,0.632631 -0.137108,-0.364967 0.406427,-0.628317 0.699339,-0.632631 z m 13.2767103,1.78852 c -0.841676,0.144728 -0.832631,1.1429291 -1.010822,1.797 -0.263141,1.144389 -1.639434,1.008653 -2.513393,1.321573 -1.168565,0.56893 0.218542,1.775553 0.456162,2.547427 0.485561,0.494033 -0.107915,-0.815149 -0.263393,-0.990565 -0.658147,-0.662256 -0.318817,-1.491595 0.596638,-1.478188 0.836148,-0.228576 1.694305,-0.404901 2.484528,-0.77246 -1.05405,-0.04681 -0.386997,-1.4858729 0.131012,-1.815401 0.233509,0.02137 0.693135,0.970521 0.658339,0.4376951 C 14.841697,9.396977 15.192942,8.805287 15.769724,8.757579 15.54454,8.714199 15.313222,8.734979 15.085561,8.723499 Z M 1.7551057,9.512596 c -0.266111,-0.0039 -1.50724197,-0.01159 -1.181155,0.1689551 0.572027,0.11446 1.797035,-0.111409 1.945704,0.197853 -0.529954,0.6396939 -1.213221,1.1242939 -1.862455,1.6330029 1.06562,-0.153599 1.807116,0.819374 1.890922,1.784204 0.07328,0.380442 0.531052,0.861968 0.24438,0.178205 -0.39176,-0.549811 -0.04501,-1.400004 0.676012,-0.958509 1.096517,0.0097 0.805102,1.174159 0.39453,1.767116 -0.149453,0.358426 0.0087,0.726713 0.18655,0.16499 0.561749,-0.88146 0.649024,-2.075607 -0.188023,-2.80805 -0.440186,-0.797793 -0.722259,-1.9333509 -1.76898,-2.102731 l -0.168071,-0.0215 -0.169412,-0.0035 z m 0.993738,0.4470031 c 0.194058,0.7431129 1.314999,1.7549349 0.797013,2.3778809 -0.740918,0.05249 -1.867351,-0.750427 -1.756724,-1.469129 0.243115,-0.377558 0.699528,-0.5473 0.959711,-0.9087519 z m 6.613033,2.2334539 c -1.016427,0.363546 -2.086916,0.591683 -3.048307,1.097168 -0.603524,0.536859 -1.020571,1.952453 -0.781342,2.387263 0.328591,-0.567578 0.323969,-1.98125 1.32729,-1.322689 0.715419,0.221464 0.06381,1.710357 0.286503,1.599626 0.300956,-0.681121 0.443291,-1.81284 1.387153,-1.828399 0.786059,-0.07418 1.202989,1.13792 1.332786,1.401869 -0.04331,-0.363999 0.117686,-1.681723 0.5388403,-1.135364 0.0079,0.340081 -0.243824,1.706891 0.06115,0.646638 0.531059,-1.02726 -0.07973,-1.996606 -0.8928393,-2.623918 l -0.106062,-0.110674 -0.105169,-0.11152 z m -0.134874,0.19482 c 0.552969,0.40265 1.6438903,1.43937 0.466791,1.824687 -0.958347,0.181073 -1.20656,-0.970217 -0.601545,-1.526938 l 0.06872,-0.14829 z m -0.478525,0.361736 c -0.268193,0.823984 -1.156655,1.870747 -2.104699,1.400109 -0.785741,-0.736767 0.487198,-0.966074 1.016451,-1.134004 0.35209,-0.125726 0.71482,-0.230411 1.088248,-0.266105 z");

dataLoom = {
    //Turn names of items in the JSON into object references.
    knotData: function() {

        for (const mach in histData.machines) {
            var mRec = histData.machines[mach].baseRecipes;
            for (const rec in mRec) {
                mRec[rec] = histData.recipes[rec];
                mRec[rec].machine = histData.machines[mach];
            }
            mRec = histData.machines[mach].hiddenRecipes;
            for (const rec in mRec) {
                mRec[rec] = histData.recipes[rec];
                mRec[rec].machine = histData.machines[mach];
            }

            histData.machines[mach].icon = images[mach];
            histData.machines[mach].displayArray = {};
        }

        for (const ele in histData.elements) {
            histData.elements[ele].consumers = {};
            histData.elements[ele].producers = {};
            if (histData.machines[histData.elements[ele].machine])
                histData.machines[histData.elements[ele].machine].displayArray[ele] = histData.elements[ele];
            histData.elements[ele].machine = histData.machines[histData.elements[ele].machine];
        }

        for (const rec in histData.recipes) {
            var mGred = histData.recipes[rec].inputs;
            for (const gred in mGred) {
                mGred[gred].type = histData.elements[mGred[gred].type];
                mGred[gred].type.consumers[rec] = histData.recipes[rec];
            }
            var mGred = histData.recipes[rec].outputs;
            for (const gred in mGred) {
                mGred[gred].type = histData.elements[mGred[gred].type];
                mGred[gred].type.producers[rec] = histData.recipes[rec];
            }
        }
    },
    //Opposite of knotting. removes circular data references for JSON stringify.
    unknotData: function() {
        for (const mach in histData.machines) {
            var tFun = function(mRec) {
                for (const rec in mRec) {
                    mRec[rec] = null;
                }
            }
            tFun(histData.machines[mach].baseRecipes)
            tFun(histData.machines[mach].hiddenRecipes)
        }
    },
    trimData: function() {
        for (const mach in histData.machines) {
            delete histData.machines[mach].displayElement;
            delete histData.machines[mach].displayArray;
            delete histData.machines[mach].displayArrayCD;
            delete histData.machines[mach].displayArrayCurrent;
            delete histData.machines[mach].displayArrayCDMax;
            delete histData.machines[mach].unpauseable;
        }
    }

}
dataLoom.knotData();
